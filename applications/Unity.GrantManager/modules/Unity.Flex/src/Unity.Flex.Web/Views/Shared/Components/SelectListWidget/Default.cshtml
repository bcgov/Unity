@using Unity.Flex.Web.Views.Shared.Components;
@using Unity.Flex.Web.Views.Shared.Components.SelectListWidget;
@using Unity.Flex.Worksheets.Definitions;
@using Unity.Flex;

@model SelectListViewModel;

@if (Model.Field != null)
{
    
    var fieldId = Model.WorksheetId.HasValue
        ? $"{Model.Field.Name}.{Model.Name}.{Model.Field.Id}.{Model.WorksheetId}"
        : $"{Model.Field.Name}.{Model.Name}.{Model.Field.Id}";
    
    <select class="@Model.Field.Type.ApplyCssClass()"
            id="@fieldId"
            name="@fieldId"
            onchange="@($"notifyFieldChange('{Model.Name}', '{Model.Field?.UiAnchor}', this)")">

        @foreach (var item in ((SelectListDefinition?)Model.Field?.Definition?.ConvertDefinition(Model.Field.Type))?.Options ?? [])
        {
            <option selected="@Model.Field?.CurrentValue?.CompareSelectListKey(@item.Key)" value="@item.Key">@item.Value</option>
        }

    </select>
}